@model TesoreriaVS12.Areas.Tesoreria.Models.Ma_TransferenciasModel

@{
    ViewBag.Title = "V_AmpliacionesReducciones";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div id="_menu_lateral">
    @if (ViewBag.post)
    {
        if (Model.De_Transferencias.Count() > 0)
        {
            if (Model.Id_Estatus == 3)
            {
                Html.RenderAction("Botonera", "Home", new { Area = "", ids = new List<object> { "bNuevo", "bBuscar", "bDetalles", "bSalir" } });
            }
            else
            {
                if (Model.Id_Estatus == 1)
                {
                    Html.RenderAction("Botonera", "Home", new { Area = "", ids = new List<object> { "bNuevo", "bBuscar", "bEditar", "bDetalles", "bEliminar", "bAfectar", "bSalir" } });
                }
                else {
                    Html.RenderAction("Botonera", "Home", new { Area = "", ids = new List<object> { "bNuevo", "bBuscar", "bDetalles", "bEliminar", "bSalir" } });
                }
                
            }
        }else{
            if (Model.Id_Estatus == 3)
            {
                Html.RenderAction("Botonera", "Home", new { Area = "", ids = new List<object> { "bNuevo", "bBuscar", "bDetalles", "bSalir" } });
            }
            else
            {
                Html.RenderAction("Botonera", "Home", new { Area = "", ids = new List<object> { "bNuevo", "bBuscar", "bEditar", "bDetalles", "bEliminar", "bSalir" } });
            }
            
        }
    }
    else
    {
        Html.RenderAction("Botonera", "Home", new { Area = "", ids = new List<object> { "bNuevo", "bBuscar", "bSalir" } }); 
    }
</div>
<link href="~/Content/datepicker3.css" rel="stylesheet" />
<div class="container">
    <h2>Ampliaciones y Reducciones </h2>

    @using (Html.BeginForm("Guardar", "Catalogos", FormMethod.Post, new { id = "frm" }))
    {
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true)
        <div class="row">
            <div class="col-sm-1">
                <label>Folio</label>
                @Html.TextBoxFor(model => model.Id_Transferencia, new { @class = "form-control jsEnabledAgregar jsEnabledEditar folio", disabled = "disabled", @readonly = "readonly" })
                @Html.ValidationMessageFor(model => model.Id_Transferencia)
            </div>
            <div class="col-sm-2">
                <label>Fecha</label>
                <div class="input-group fecha_group">
                    <input type="text" name="Fecha" id="Fecha" class="form-control jsEnabledAgregar jsEnabledEditar date" disabled = "disabled" value="@DateTime.Now.ToString("dd/MM/yyyy")" />
                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                </div>
            </div>
            <div class="col-sm-3">
                <label>Ampliación </label>
                <input id="rAmpliacion" type="radio" value="1" name="Id_TipoT"  onclick="ReanOnlyImportes()" checked="checked" class="jsEnabledAgregar" disabled="disabled" />
                <label>Reducción </label>
                <input id="rReduccion" type="radio" value="2" name="Id_TipoT"  onclick="ReanOnlyImportes()"  class="jsEnabledAgregar" disabled="disabled" />
            </div>
            <div class="col-sm-2">
                <label>Importe Ampliación</label>
                <input type="text" id="Importe_AMP_f" name="Importe_AMP" class="form-control importe" value="@if (Model.Importe_AMP != null) { Model.Importe_AMP.Value.ToString("N"); } else { String.Format("{0:N}",0); }" readonly="readonly" />
                 <label>Importe Reducción</label>
                <input type="text" id="Importe_RED_f" name="Importe_RED" class="form-control importe" value="@if (Model.Importe_RED != null) { Model.Importe_RED.Value.ToString("N"); } else { String.Format("{0:N}", 0); }"  readonly="readonly" />
            </div>
            <div class="col-sm-2 col-sm-offset-1">
                <label>Estatus</label>
                @Html.DropDownListFor(model => model.Id_Estatus, Model.ListaEstatus, new { disabled = "disabled",@class="form-control" })
                @Html.ValidationMessageFor(model => model.Id_Estatus)
                <label>Fecha de Afectación</label>
                <div class="input-group fecha_group">
                    @Html.TextBoxFor(model => model.Fecha_Afecta, new { @class = "form-control", disabled = "disabled" })
                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                </div>
                @Html.ValidationMessageFor(model => model.Fecha_Afecta)
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12">
                <label>Descripción</label>
                @Html.TextBoxFor(model => model.Descrip, new { @class = "form-control jsEnabledAgregar jsEnabledEditar", disabled = "disabled" })
                @Html.ValidationMessageFor(model => model.Descrip)
            </div>
        </div>
        <div class="row">
            <div class="col-sm-3">
                <label>Póliza de Orden Modificado</label>
                @Html.HiddenFor(model => model.Id_MesPO_Modificado)
                <div class="input-group folio_mes">
                    <input id="PolizaOrdenModificado" name="PolizaOrdenModificado" type="text" class="form-control " readonly="readonly" />
                    @Html.HiddenFor(model => model.Id_FolioPO_Modificado)
                    <span class="input-group-addon js_ConsultaPoliza" data-tipo="4"><i class="fa fa-search"></i></span>
                </div>
            </div>
            <div class="col-sm-4">
                <label>Cancelación de Póliza de Orden Modificado</label>
                @Html.HiddenFor(model => model.Id_MesPO_Modificado_Cancela)
                <div class="input-group folio_mes">
                    <input id="PolizaOrdenCancelado" name="PolizaOrdenCancelado" type="text" class="form-control " readonly="readonly" />
                    @Html.HiddenFor(model => model.Id_FolioPO_Modificado_Cancela)
                    <span class="input-group-addon js_ConsultaPoliza" data-tipo="4"><i class="fa fa-search"></i></span>
                </div>
            </div>
            <div class="col-sm-2">
            </div>

        </div>

    }

</div>
@section scripts{
    <script src="~/Scripts/bootstrap-datepicker.js"></script>
    <script src="~/Scripts/jquery.validate.min.js"></script>
    <script src="~/Scripts/jquery.validate.unobtrusive.min.js" class="jsValidate"></script>
    <script src="~/Areas/Tesoreria/Scripts/AmpliacionesReducciones.js"></script>
    <script src="~/Areas/Tesoreria/Scripts/ConsultaPoliza.js"></script>
    <script src="~/Areas/Tesoreria/Scripts/autoNumeric.js"></script>

    <script type="text/javascript">
        var cancelar = 0;
        var tempDesc = "";
        var rutaVDeTrans = "@Url.Action("V_DeTransferencia", "Presupuestos")";
        var rutaGuardarAmpRed = "@Url.Action("GuardarAmpRed", "Presupuestos")";
        $(document).ready(function () {
            $("#Importe_AMP_f").autoNumeric({ aSep: "" });
            $("#Importe_RED_f").autoNumeric({ aSep: "" });
            
            $("#Total").autoNumeric({ aSign: "$" });
            $("body").tooltip({ selector: "[data-toggle='tooltip']" });
            $('.date').datepicker({
                format: "dd/mm/yyyy",
                autoclose: true,
                startDate: '@Html.Raw(ViewBag.FechaInicio)',
                endDate: '@Html.Raw(ViewBag.FechaFin)'
            })
            $('body').on("click", ".js_radio", changeRadio);
            $("body").on("click", ".js_seleccionar", Seleccionar);
            //OPCIONES DEL MENU
            $('body').on("click", "#js_mNuevo", Agregar);
            $('body').on("click", "#js_mCancelar", Cancelar);
            $('body').on("click", "#js_mBuscar", ModalBuscar);
            $('body').on("click", "#js_mGuardar", Guardar);
            $('body').on("click", "#js_mEditar", Editar);
            $('body').on("click", "#js_mEliminar", ModalEliminar);
            $('body').on("click", "#js_mAfectar", ModalAfectar);
            $('body').on("click", "#js_mDetalles", Detalles);
            $('body').on('click', '#js_mSalir', function () { GoHome(); });
            /**************Consulta poliza*****************/
            $(".js_ConsultaPoliza").on("click", function () {
                ConsultaPoliza($(this).data("tipo"), $(this).siblings("input[type=hidden]").val(), $(this).parent().siblings("input[type=hidden]").val());
            });
            /************************************************************/
        });

    </script>


}
